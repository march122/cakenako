;/*FB_PKG_DELIM*/

__d("LSIssueAttachmentsRangeQuery",["LSGetCursor","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(a){return c.storedProcedure(b("LSGetCursor"),c.i64.cast([0,1])).then(function(a){return a=a,d[0]=a[0],a})},function(e){return c.db.table(17).fetch([[[a[0],a[1]]]]).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[2]=c.i64.cast([0,1]):(e=b.item,d[7]=e.syncGroup,c.i64.neq(d[7],void 0)?d[6]=d[7]:d[6]=c.i64.cast([0,1]),d[2]=d[6])})},function(e){return d[4]=new c.Map(),d[4].set("thread_key",a[0]),d[4].set("media_group",a[1]),d[4].set("max_timestamp_ms",c.i64.cast([2328,1316134911])),d[4].set("cursor",d[0]),d[4].set("sync_group",d[2]),d[4].set("last_loaded_message_id",void 0),d[5]=c.toJSON(d[4]),c.storedProcedure(b("LSIssueNewTask"),"arq",c.i64.cast([0,105]),d[5],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]):(f=e.item,f.hasMoreBefore?c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[2]=c.i64.cast([0,1]):(e=b.item,d[7]=e.syncGroup,c.i64.neq(d[7],void 0)?d[6]=d[7]:d[6]=c.i64.cast([0,1]),d[2]=d[6])})},function(e){return d[4]=new c.Map(),d[4].set("thread_key",a[0]),d[4].set("media_group",a[1]),d[4].set("max_timestamp_ms",f.minTimestampMs),d[4].set("cursor",d[0]),d[4].set("sync_group",d[2]),d[4].set("last_loaded_message_id",void 0),d[5]=c.toJSON(d[4]),c.storedProcedure(b("LSIssueNewTask"),"arq",c.i64.cast([0,105]),d[5],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]):c.resolve())})}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxIssueAttachmentsRangeQueryStoredProcedure";e.exports=a}),null);
__d("LSIssueAttachmentsRangeQueryStoredProcedure",["LSIssueAttachmentsRangeQuery","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){return c("LSIssueAttachmentsRangeQuery")(b.threadKey,b.mediaGroup,a)}g["default"]=a}),98);
__d("MDSShareSvgIcon.react",["MDSSvgIcon.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=d("react"))).c,j=h;function a(a){var b=i(4),d,e;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(d=j.jsx("path",{d:"M18.766 4.857a1 1 0 00-1.532 0L13.878 8.86a1 1 0 00.766 1.643H16.5a.25.25 0 01.25.25v10.75a1 1 0 001 1h.5a1 1 0 001-1v-10.75a.25.25 0 01.25-.25h1.856a1 1 0 00.766-1.643l-3.356-4.002z"}),e=j.jsx("path",{d:"M14.75 13.502a1 1 0 00-1-1H12.5a4 4 0 00-4 4v8.5a4 4 0 004 4h11a4 4 0 004-4v-8.5a4 4 0 00-4-4h-1.25a1 1 0 00-1 1v.5a1 1 0 001 1h1.25a1.5 1.5 0 011.5 1.5v8.5a1.5 1.5 0 01-1.5 1.5h-11a1.5 1.5 0 01-1.5-1.5v-8.5a1.5 1.5 0 011.5-1.5h1.25a1 1 0 001-1v-.5z"}),b[0]=d,b[1]=e):(d=b[0],e=b[1]);b[2]!==a?(d=j.jsxs(c("MDSSvgIcon.react"),babelHelpers["extends"]({},a,{children:[d,e]})),b[2]=a,b[3]=d):d=b[3];return d}g["default"]=a}),98);
__d("MWChatAttachmentMediaState.react",["$InternalEnum","I64","LSIntEnum","MAWGetIsMediaDownloadStatusEnabled","MAWStateContext.react","MessagingAttachmentType","RavenMessagingState","ReQL","ReQLSuspense","cr:10985","cr:7625","emptyFunction","filterNulls","justknobx","react","usePrevious","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=i||(i=d("react"));e=i;var m=e.createContext,n=e.useCallback,o=e.useContext,p=e.useEffect,q=e.useMemo,r=e.useRef,s=e.useState,t=(e=b("cr:10985"))!=null?e:{maybeDownloadMediaInWorker:c("emptyFunction")},u=b("$InternalEnum")({Image:0,Video:1}),v=m({canMoveBackward:!1,canMoveForward:!1,card:void 0,cards:[],currentIndex:0,moveBackward:function(){},moveForward:function(){},moveTo:function(){},numberOfCards:0,shouldTriggerLoadMore:!1});function w(a){var b=a.attachmentType;a=a.ephemeralMediaState;return a!=null&&(j||(j=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_IMAGE))&&(j||(j=d("I64"))).equal(a,(k||(k=d("LSIntEnum"))).ofNumber(c("RavenMessagingState").PERMANENT))}function x(a){var b=a.attachmentType;a=a.ephemeralMediaState;return a!=null&&(j||(j=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_VIDEO))&&(j||(j=d("I64"))).equal(a,(k||(k=d("LSIntEnum"))).ofNumber(c("RavenMessagingState").PERMANENT))}function y(a,b,c,d){return c?d.hasMedia:b(d,"isPlayableMedia")!=null&&a(d,"isPlayableMedia")!=null}function z(a,b,e,f){var g=f.attachmentType;return!y(a,b,e,f)?!1:w(f)||(j||(j=d("I64"))).equal(g,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))}function A(a,b,e,f){var g=f.attachmentType;return!y(a,b,e,f)?!1:x(f)||(j||(j=d("I64"))).equal(g,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))}function B(a,b){p(function(){a.forEach(function(a){try{a.attachment.hasMedia&&b(a.attachment,"usePreloadThumbnails");return}catch(a){return}})},[a,b])}function C(a){var e=a.attachments,f=a.children,g=a.getIsSecureThread,h=a.getPlayableUrl,i=a.getPreviewUrl;a=a.initialAttachment;a=s(a);var j=a[0],k=a[1];a=c("usePrevious")(j==null?void 0:j.messageId);var m=o(d("MAWStateContext.react").MAWStateContext),n=m.dispatch,w=r(new Map());p(function(){!c("justknobx")._("3011")?e.forEach(function(a){var b=g(a);b&&a.hasMedia===!1&&t.maybeDownloadMediaInWorker({attachment:a,dispatch:n,mediaRenderQpl:null,triggerUIView:"fullsize"})}):d("MAWGetIsMediaDownloadStatusEnabled").getIsMediaDownloadStatusEnabled()||e.forEach(function(a){var b,c=g(a);b=(b=w.current.get(a.attachmentFbid))!=null?b:!1;c&&a.hasMedia===!1&&!b&&(w.current.set(a.attachmentFbid,!0),t.maybeDownloadMediaInWorker({attachment:a,dispatch:n,mediaRenderQpl:null,triggerUIView:"fullsize"}))})},[e,n,g]);m=q(function(){return e.map(function(a){return{attachment:a,mediaRenderQpl:null}})},[e]);b("cr:7625")(m,"fullsize");var x=q(function(){return c("filterNulls")(e.map(function(a){var b=g(a);if(z(h,i,b,a))return{attachment:a,type:u.Image};return A(h,i,b,a)?{attachment:a,type:u.Video}:null}))},[e,g,h,i]),y=j==null?-1:x.findIndex(function(a){return a.attachment.attachmentFbid===j.attachmentFbid&&a.attachment.messageId===j.messageId}),C=a!=null&&(j==null?void 0:j.messageId)!==a&&y>x.length-5;B(x,i);m=q(function(){var a=Math.max(0,x.length-1);return{canMoveBackward:y>0&&y!==-1,canMoveForward:y<a&&y!==-1,card:x[y],cards:x,currentIndex:y,moveBackward:function(){var a=Math.max(y-1,0);k((a=x[a])==null?void 0:a.attachment)},moveForward:function(){var b=Math.min(y+1,a);k((b=x[b])==null?void 0:b.attachment)},moveTo:function(a){k(a.attachment)},numberOfCards:x.length,shouldTriggerLoadMore:c("justknobx")._("1571")?C:!1}},[x,y,C]);return l.jsx(v.Provider,{value:m,children:f})}C.displayName=C.name+" [from "+f.id+"]";function a(a){var b=a.attachmentFbid,e=a.children,g=a.getPlayableUrl,i=a.getPreviewUrl,k=a.isSecureThread,m=a.threadKey,o=(h||(h=c("useReStore")))();a=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableAscending(o.tables.attachments).getKeyRange(m).filter(function(a){return a.attachmentFbid===b})},[o,m,b],f.id+":366");var p=d("ReQLSuspense").useArray(function(){return d("ReQL").fromTableAscending(o.tables.attachments).getKeyRange(m).filter(function(a){return z(g,i,k,a)||A(g,i,k,a)})},[o.tables.attachments,m,g,i,k],f.id+":374"),r=q(function(){return p.sort(function(a,b){return(j||(j=d("I64"))).compare(b.timestampMs,a.timestampMs)})},[p]),s=n(function(){return k},[k]);return l.jsx(C,{attachments:r,getIsSecureThread:s,getPlayableUrl:g,getPreviewUrl:i,initialAttachment:a,children:e})}a.displayName=a.name+" [from "+f.id+"]";g.AttachmentMediaType=u;g.context=v;g.MWChatAttachmentMediaStateProviderFromAttachments=C;g.MWChatAttachmentMediaStateProvider=a}),98);
__d("MWChatAttachmentMediaNavigationHotkeys.react",["fbt","CometKeys","MWChatAttachmentMediaState.react","react","react-forget-runtime","useLayerKeyCommands"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;b.useContext;b.useMemo;var k=b.c,l={key:c("CometKeys").LEFT},m={key:c("CometKeys").RIGHT},n={key:c("CometKeys").ESCAPE},o=h._("__JHASH__6tFY25IlnV4__JHASH__"),p=h._("__JHASH__HYvhkJNYo2M__JHASH__"),q=h._("__JHASH__mWoEKBNqFLb__JHASH__");function a(a){var b=k(12),e=a.children;a=a.onClose;var f=d("react-forget-runtime").useContextWithBailoutExperiment__unstable(d("MWChatAttachmentMediaState.react").context,r),g=f.moveBackward;f=f.moveForward;var h;b[0]!==g?(h={command:l,description:o,handler:g},b[0]=g,b[1]=h):h=b[1];b[2]!==f?(g={command:m,description:p,handler:f},b[2]=f,b[3]=g):g=b[3];b[4]!==a?(f=a!=null?{command:n,description:q,handler:a}:null,b[4]=a,b[5]=f):f=b[5];b[6]!==h||b[7]!==g||b[8]!==f?(a=[h,g,f].filter(Boolean),b[6]=h,b[7]=g,b[8]=f,b[9]=a):a=b[9];h=a;g=h;c("useLayerKeyCommands")(g);a=(f=e)!=null?f:null;b[10]!==a?(h=j.jsx("div",{children:a}),b[10]=a,b[11]=h):h=b[11];return h}function r(a){return[a.moveBackward,a.moveForward]}g.keyLeft=l;g.keyRight=m;g.keyEscape=n;g.MWChatAttachmentMediaNavigationHotkeys=a}),226);
__d("MWV2MediaViewerContext.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useMemo;var j=b.c,k=i.createContext({getDownloadUrl:function(){},getPlayableUrl:function(){},getPreviewUrl:function(){},heroLoggingComponent:function(a){return null},loadMore:function(){},media:[]});function a(a){var b=j(10),c=a.children,d=a.getDownloadUrl,e=a.getPlayableUrl,f=a.getPreviewUrl,g=a.heroLoggingComponent,h=a.loadMore;a=a.media;var l;b[0]!==d||b[1]!==e||b[2]!==f||b[3]!==g||b[4]!==h||b[5]!==a?(l={getDownloadUrl:d,getPlayableUrl:e,getPreviewUrl:f,heroLoggingComponent:g,loadMore:h,media:a},b[0]=d,b[1]=e,b[2]=f,b[3]=g,b[4]=h,b[5]=a,b[6]=l):l=b[6];d=l;e=d;b[7]!==e||b[8]!==c?(f=i.jsx(k.Provider,{value:e,children:c}),b[7]=e,b[8]=c,b[9]=f):f=b[9];return f}g.context=k;g.MWV2MediaViewerContextProvider=a}),98);
__d("MWChatAttachmentMediaThumbnails.react",["CometMediaViewerFilmstrip.react","CometPlaceholder.react","MWChatAttachmentMediaState.react","MWV2MediaViewerContext.react","gkx","react","react-forget-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useContext,k=b.useDeferredValue,l=b.c;function m(a){var b=a.card,e=a.getPlayableUrl;a=a.getPreviewUrl;var f=b.attachment,g,h="/images/comet/gray.png";if(f.hasMedia===!1)g=h;else{g=(a=a(f,"toFilmstripThumbnail"))!=null?a:h}a=g;b.type===d("MWChatAttachmentMediaState.react").AttachmentMediaType.Video&&!Boolean(g)&&c("gkx")("3368")&&(a=e(f,"toFilmstripThumbnail"));if(b.type===d("MWChatAttachmentMediaState.react").AttachmentMediaType.Image){return{alt:(h=f.accessibilitySummaryText)!=null?h:"",backgroundColor:void 0,height:0,isUseImageResizing:void 0,mediaType:"image",uri:g,width:0}}return{height:0,mediaType:"video",thumbnailUri:g,uri:a,width:0}}function n(a){var b=l(21),e=a.activeCard,f=a.cards,g=a.getPreviewUrl,h=a.onSetImage,k=j(d("MWV2MediaViewerContext.react").context);b[0]!==k?(a=function(a,b){return a==null?"":(a=k.getDownloadUrl(a,b))!=null?a:""},b[0]=k,b[1]=a):a=b[1];var n=a;if(b[2]!==n||b[3]!==g||b[4]!==f){b[6]!==n||b[7]!==g?(a=function(a){return m({card:a,getPlayableUrl:n,getPreviewUrl:g})},b[6]=n,b[7]=g,b[8]=a):a=b[8];a=f.map(a);b[2]=n;b[3]=g;b[4]=f;b[5]=a}else a=b[5];a=a;if(b[9]!==e||b[10]!==f){var o;b[12]!==e?(o=function(a){var b;return a.attachment.attachmentFbid===(e==null?void 0:(b=e.attachment)==null?void 0:b.attachmentFbid)&&a.attachment.messageId===(e==null?void 0:(b=e.attachment)==null?void 0:b.messageId)},b[12]=e,b[13]=o):o=b[13];o=f.findIndex(o);b[9]=e;b[10]=f;b[11]=o}else o=b[11];o=o;var p;b[14]!==h||b[15]!==f?(p=function(a){return h(f[a])},b[14]=h,b[15]=f,b[16]=p):p=b[16];var q;b[17]!==o||b[18]!==a||b[19]!==p?(q=i.jsx(c("CometMediaViewerFilmstrip.react"),{activeIndex:o,images:a,onSetImage:p}),b[17]=o,b[18]=a,b[19]=p,b[20]=q):q=b[20];return q}function a(a){var b=l(6);a=a.getPreviewUrl;var e=d("react-forget-runtime").useContextWithBailoutExperiment__unstable(d("MWChatAttachmentMediaState.react").context,o),f=e.card,g=e.cards;e=e.moveTo;g=k(g);var h;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(h="xdj266r xkrivgy xat24cr x1gryazu x193iq5w x6ikm8r x10wlt62",b[0]=h):h=b[0];b[1]!==f||b[2]!==g||b[3]!==a||b[4]!==e?(h=i.jsx("div",{className:h,children:i.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWChatAttachmentMediaThumbnails",children:i.jsx(n,{activeCard:f,cards:g,getPreviewUrl:a,onSetImage:e})})}),b[1]=f,b[2]=g,b[3]=a,b[4]=e,b[5]=h):h=b[5];return h}function o(a){return[a.card,a.cards,a.moveTo]}g["default"]=a}),98);
__d("MWChatForwardCircleButton.react",["fbt","MDSShareSvgIcon.react","ODS","SVGIcon","TetraCircleButton.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=(i||(i=d("react"))).c,l=i;function a(a){var b=k(9),e=a.color,f=a.onOpenForwardDialog;a=a.type;var g;b[0]!==e?(g=d("SVGIcon").legacySVGIcon(function(){return l.jsx(c("MDSShareSvgIcon.react"),{color:e,size:24})}),b[0]=e,b[1]=g):g=b[1];var i;b[2]===Symbol["for"]("react.memo_cache_sentinel")?(i=h._("__JHASH__GvPr2MwluxY__JHASH__"),b[2]=i):i=b[2];var m;b[3]!==f?(m=function(){(j||(j=d("ODS"))).bumpEntityKey(3185,"mwchat_media_viewer","forward"),f()},b[3]=f,b[4]=m):m=b[4];bb0:{switch(a){case"deemphasized":a="deemphasized";break bb0;case"normal":a="normal";break bb0;case"overlay":a="overlay";break bb0;case"dark_overlay":a="dark-overlay";break bb0;case"deemphasized_overlay":case"overlay_raised":a="overlay-raised";break bb0;case"primary_background_overlay":a="primary-background-overlay";break bb0}a=void 0}b[5]!==g||b[6]!==m||b[7]!==a?(i=l.jsx(c("TetraCircleButton.react"),{icon:g,label:i,onPress:m,size:36,testid:void 0,type_DEPRECATED:a}),b[5]=g,b[6]=m,b[7]=a,b[8]=i):i=b[8];return i}g["default"]=a}),226);
__d("MWMediaViewerRenderQpl",["MWMediaRenderQplUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MWMediaRenderQplUtils").useCommonMediaRenderQplForAttachment(a,b,"full_screen_view")}g.useMediaViewerRenderQpl=a}),98);
__d("MWSharedAttachmentsSectionHooks",["I64","LSIntEnum","LSThreadMediaGalleryGroup","MessagingAttachmentType","ReQL","ReQLSuspense","gkx","react","usePrevious","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=k||d("react");l.useCallback;var m=l.useEffect,n=l.useState,o=l.c;function a(a){var b=o(33),d=a.attachmentsRange,e=a.hasMore,f=a.loadMore,g=a.logLoadMediaCancel,h=a.logLoadMediaSuccess,i=a.media,j=a.skipInitialLoad;a=n(!1);var k=a[0],l=a[1],p=i.length,q=(a=c("usePrevious")(p))!=null?a:0,r=c("usePrevious")(e),s=(i=c("usePrevious")(k))!=null?i:!1,t=d!=null;b[0]!==t||b[1]!==j||b[2]!==f?(a=function(){!t&&j!==!0&&(f(),c("gkx")("2616")===!0&&l(!0))},i=[t,f,j],b[0]=t,b[1]=j,b[2]=f,b[3]=a,b[4]=i):(a=b[3],i=b[4]);m(a,i);b[5]!==q||b[6]!==p||b[7]!==r||b[8]!==e||b[9]!==d||b[10]!==k||b[11]!==h||b[12]!==s||b[13]!==f?(a=function(){var a=q!==p,b=r===!0&&!e||d==null&&e===!1&&r===!1&&q===p&&c("gkx")("2616")===!0;k&&(b||a)?(l(!1),h==null?void 0:h({fetchedMediaCount:p-q,startMediaCount:q})):q===p&&e&&k&&s===!0&&c("gkx")("2616")===!0&&(h==null?void 0:h({fetchedMediaCount:p-q,isAlreadyPreloaded:!0,startMediaCount:q}),f())},b[5]=q,b[6]=p,b[7]=r,b[8]=e,b[9]=d,b[10]=k,b[11]=h,b[12]=s,b[13]=f,b[14]=a):a=b[14];b[15]!==p||b[16]!==e||b[17]!==k||b[18]!==q||b[19]!==r||b[20]!==d||b[21]!==f||b[22]!==s||b[23]!==h||b[24]!==g?(i=[p,e,k,q,r,d,f,s,h,g],b[15]=p,b[16]=e,b[17]=k,b[18]=q,b[19]=r,b[20]=d,b[21]=f,b[22]=s,b[23]=h,b[24]=g,b[25]=i):i=b[25];m(a,i);b[26]!==k||b[27]!==f?(g=function(){if(!k){f();return l(!0)}},b[26]=k,b[27]=f,b[28]=g):g=b[28];a=g;i=p>0||!k&&!e;b[29]!==k||b[30]!==a||b[31]!==i?(g=[k,a,i],b[29]=k,b[30]=a,b[31]=i,b[32]=g):g=b[32];return g}function p(a,b,e,g){var i=o(19),j;i[0]!==g?(j=g===void 0?{}:g,i[0]=g,i[1]=j):j=i[1];g=j;j=g.removeUnsentMessages;var k=j===void 0?!1:j,l=(h||(h=c("useReStore")))();g=u(a,b);j=g.attachmentsRange;b=g.hasMoreBefore;var m=g.minTimestampMs,n=g.query;i[2]!==e||i[3]!==k||i[4]!==l?(g=function(a){if(!e(a))return null;if(!k)return a;var b=d("ReQLSuspense").first(d("ReQL").fromTableAscending(l.tables.messages.index("messageId")).getKeyRange(a.messageId),f.id+":154");return b==null||b.isUnsent?null:a},i[2]=e,i[3]=k,i[4]=l,i[5]=g):g=i[5];var p=g;i[6]!==n||i[7]!==p?(g=function(){return n.map(p).filter(Boolean)},i[6]=n,i[7]=p,i[8]=g):g=i[8];var q;i[9]!==l||i[10]!==a||i[11]!==p||i[12]!==m?(q=[l,a,p,m],i[9]=l,i[10]=a,i[11]=p,i[12]=m,i[13]=q):q=i[13];a=d("ReQLSuspense").useArray(g,q,f.id+":167");i[14]!==a||i[15]!==j||i[16]!==m||i[17]!==b?(g=[a,j,m,b],i[14]=a,i[15]=j,i[16]=m,i[17]=b,i[18]=g):g=i[18];return g}function q(a){var b=a.attachmentType;a=a.defaultCtaType;return(i||(i=d("I64"))).equal(b,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA))?a==="xma_web_url":!1}function b(a,b){var e=o(7),f;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").LINKS),e[0]=f):f=e[0];a=p(a,f,q,b);f=a[0];b=a[1];var g=a[2];a=a[3];var h;e[1]===Symbol["for"]("react.memo_cache_sentinel")?(h=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").LINKS),e[1]=h):h=e[1];e[2]!==f||e[3]!==b||e[4]!==g||e[5]!==a?(h=[f,h,b,g,a],e[2]=f,e[3]=b,e[4]=g,e[5]=a,e[6]=h):h=e[6];return h}function r(a){a=a.attachmentType;return(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))}function e(a,b){var e=o(7),f;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),e[0]=f):f=e[0];a=p(a,f,r,b);f=a[0];b=a[1];var g=a[2];a=a[3];var h;e[1]===Symbol["for"]("react.memo_cache_sentinel")?(h=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),e[1]=h):h=e[1];e[2]!==f||e[3]!==b||e[4]!==g||e[5]!==a?(h=[f,h,b,g,a],e[2]=f,e[3]=b,e[4]=g,e[5]=a,e[6]=h):h=e[6];return h}function s(a){a=a.attachmentType;return(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").FILE))}function t(a,b){var e=o(7),f;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").FILES_ONLY),e[0]=f):f=e[0];a=p(a,f,s,b);f=a[0];b=a[1];var g=a[2];a=a[3];var h;e[1]===Symbol["for"]("react.memo_cache_sentinel")?(h=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").FILES_ONLY),e[1]=h):h=e[1];e[2]!==f||e[3]!==b||e[4]!==g||e[5]!==a?(h=[f,h,b,g,a],e[2]=f,e[3]=b,e[4]=g,e[5]=a,e[6]=h):h=e[6];return h}function u(a,b){var e,g=o(17),j=(h||(h=c("useReStore")))(),k;g[0]!==j.tables.attachments_ranges_v2__generated||g[1]!==a||g[2]!==b?(k=function(){return d("ReQL").fromTableDescending(j.tables.attachments_ranges_v2__generated).getKeyRange(a).filter(function(a){return(i||(i=d("I64"))).equal(a.mediaGroup,b)})},g[0]=j.tables.attachments_ranges_v2__generated,g[1]=a,g[2]=b,g[3]=k):k=g[3];var l;g[4]!==j||g[5]!==a||g[6]!==b?(l=[j,a,b],g[4]=j,g[5]=a,g[6]=b,g[7]=l):l=g[7];k=d("ReQLSuspense").useFirst(k,l,f.id+":291");l=k==null?void 0:k.minTimestampMs;e=c("gkx")("2616")===!0?k==null?void 0:k.hasMoreBefore:(e=k==null?void 0:k.hasMoreBefore)!=null?e:!1;if(g[8]!==j.tables.attachments||g[9]!==a||g[10]!==l){var m=d("ReQL").fromTableDescending(j.tables.attachments.index("fk_messages")).getKeyRange(a);m=l!=null&&(i||(i=d("I64"))).to_float(l)!==Number.MAX_SAFE_INTEGER&&c("gkx")("5318")===!0?m.bounds({gte:d("ReQL").key(l)}):m;g[8]=j.tables.attachments;g[9]=a;g[10]=l;g[11]=m}else m=g[11];m=m;var n;g[12]!==k||g[13]!==e||g[14]!==l||g[15]!==m?(n={attachmentsRange:k,hasMoreBefore:e,minTimestampMs:l,query:m},g[12]=k,g[13]=e,g[14]=l,g[15]=m,g[16]=n):n=g[16];return n}g.useLoader=a;g.useQueryLinkAttachments=b;g.filterMediaAttachments=r;g.useQueryMediaAttachments=e;g.useQueryFileAttachments=t;g.useAttachmentsQuery=u}),98);
__d("MWV2MediaViewerControls.react",["fbt","ix","Int64Hooks","LSMessagingThreadTypeUtil","MDSRow.react","MDSRowItem.react","MWChatForwardCircleButton.react","MWV2MediaViewerContext.react","MWXTooltip.react","TetraCircleButton.react","fbicon","react","useMWHasForwardAction","useMWV2MessageForwardAction"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=j||(j=d("react"));b=j;var l=b.useContext,m=b.c,n=h._("__JHASH__yVgFxyhzJWR__JHASH__");function a(a){var b=m(15),e=a.attachment,f=a.message,g=a.onClose;a=a.thread;var j=l(d("MWV2MediaViewerContext.react").context),p;b[0]!==j||b[1]!==e?(p=j.getDownloadUrl(e,"MWV2MediaViewerControls"),b[0]=j,b[1]=e,b[2]=p):p=b[2];j=p;b[3]!==j?(p=j!=null?k.jsx(c("MDSRowItem.react"),{children:k.jsx(c("MWXTooltip.react"),{tooltip:n,children:k.jsx(c("TetraCircleButton.react"),{color_DEPRECATED:"white",icon:d("fbicon")._(i("1873235"),16),label:n,linkProps:{download:!0,target:"_blank",url:j},size:36,type_DEPRECATED:"dark-overlay"})})}):null,b[3]=j,b[4]=p):p=b[4];b[5]!==f||b[6]!==e||b[7]!==a?(j=f!=null?k.jsx(o,{attachment:e,message:f,thread:a}):null,b[5]=f,b[6]=e,b[7]=a,b[8]=j):j=b[8];b[9]!==g?(f=g!=null?k.jsx(c("MDSRowItem.react"),{children:k.jsx(c("TetraCircleButton.react"),{color_DEPRECATED:"white",icon:d("fbicon")._(i("478232"),16),label:h._("__JHASH__gaxHiFwvIGk__JHASH__"),onPress:g,size:36,type_DEPRECATED:"dark-overlay"})}):null,b[9]=g,b[10]=f):f=b[10];b[11]!==p||b[12]!==j||b[13]!==f?(e=k.jsxs(c("MDSRow.react"),{paddingTop:0,spacing:8,children:[p,j,f]}),b[11]=p,b[12]=j,b[13]=f,b[14]=e):e=b[14];return e}function o(a){var b=m(9),e=a.attachment,f=a.message,g=a.thread;a=e==null?void 0:e.attachmentFbid;var i;b[0]!==g.threadType?(i=d("LSMessagingThreadTypeUtil").isArmadilloSecure(g.threadType),b[0]=g.threadType,b[1]=i):i=b[1];i=i;var j,l;b[2]!==g.threadType?(j=function(){return g.threadType},l=[g.threadType],b[2]=g.threadType,b[3]=j,b[4]=l):(j=b[3],l=b[4]);j=d("Int64Hooks").useMemoInt64(j,l);l=c("useMWV2MessageForwardAction")(i,f,j);i=c("useMWHasForwardAction")(g.threadType,f,e);j=i.shouldShowForwardAction;if(a==null||!j)return null;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(f=h._("__JHASH__GvPr2MwluxY__JHASH__"),b[5]=f):f=b[5];b[6]!==a||b[7]!==l?(e=k.jsx(c("MDSRowItem.react"),{children:k.jsx(c("MWXTooltip.react"),{tooltip:f,children:k.jsx(c("MWChatForwardCircleButton.react"),{attachmentID:a,color:"white",onOpenForwardDialog:l,type:"dark_overlay"})})}),b[6]=a,b[7]=l,b[8]=e):e=b[8];return e}g["default"]=a}),226);
__d("MWV2MediaViewerItemImage.react",["MWV2MediaViewerContext.react","react","react-forget-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useContext;var j=b.useEffect,k=b.useRef,l=b.c;function a(a){var b=l(20),c=a.attachment,e=a.mediaRenderQpl;a=d("react-forget-runtime").useContextWithBailoutExperiment__unstable(d("MWV2MediaViewerContext.react").context,m);var f=a.getPlayableUrl;a=a.heroLoggingComponent;var g=k(null),h,n;b[0]!==e?(h=function(){var a;g.current!=null&&((a=g.current)==null?void 0:a.complete)&&e.endSuccess()},n=[e],b[0]=e,b[1]=h,b[2]=n):(h=b[1],n=b[2]);j(h,n);b[3]!==f||b[4]!==c||b[5]!==e?(h=f(c,"MediaViewerImage",e),b[3]=f,b[4]=c,b[5]=e,b[6]=h):h=b[6];n=h;if(n!=null){b[7]!==a?(f=a("MWV2MediaViewerImage"),b[7]=a,b[8]=f):f=b[8];b[9]===Symbol["for"]("react.memo_cache_sentinel")?(c="xr1yuqi xkrivgy x4ii5y1 x1gryazu xmz0i5r x193iq5w x1ja2u2z",b[9]=c):c=b[9];b[10]!==e?(h=function(){e.endFail("load-image-error")},a=function(){e.endSuccess()},b[10]=e,b[11]=h,b[12]=a):(h=b[11],a=b[12]);b[13]!==h||b[14]!==a||b[15]!==n?(c=i.jsx("img",{className:c,onError:h,onLoad:a,ref:g,src:n}),b[13]=h,b[14]=a,b[15]=n,b[16]=c):c=b[16];b[17]!==f||b[18]!==c?(h=i.jsxs(i.Fragment,{children:[f,c]}),b[17]=f,b[18]=c,b[19]=h):h=b[19];return h}else{e.endFail("missing-playable-url");return null}}function m(a){return[a.getPlayableUrl,a.heroLoggingComponent]}g["default"]=a}),98);
__d("MWV2MediaViewerItemVideo.react",["MWChatVideoPlayer.react","MWV2MediaViewerContext.react","react","react-forget-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useContext;var j=b.c;function a(a){var b=j(9),e=a.attachment;a=a.mediaRenderQpl;var f=d("react-forget-runtime").useContextWithBailoutExperiment__unstable(d("MWV2MediaViewerContext.react").context,k);f=f.getPlayableUrl;var g;b[0]!==f||b[1]!==e||b[2]!==a?(g=f(e,"MediaViewerVideo",a),b[0]=f,b[1]=e,b[2]=a,b[3]=g):g=b[3];f=g;if(f!=null){b[4]===Symbol["for"]("react.memo_cache_sentinel")?(g="x78zum5 x1iyjqo2 xmz0i5r",b[4]=g):g=b[4];b[5]!==e.attachmentFbid||b[6]!==a||b[7]!==f?(g=i.jsx("div",{className:g,children:i.jsx(c("MWChatVideoPlayer.react"),{controls:"mwchat",fbid:e.attachmentFbid,hideExpandButton:!1,isMediaViewer:!0,mediaRenderQpl:a,originalHeight:1e3,originalWidth:1e3,sdSrc:f,shouldForcePauseOnClick:!1})}),b[5]=e.attachmentFbid,b[6]=a,b[7]=f,b[8]=g):g=b[8];return g}else{a.endFail("missing-playable-url");return null}}function k(a){return[a.getPlayableUrl]}g["default"]=a}),98);
__d("MWV2MediaViewerNullState.react",["fbt","CometColumn.react","CometColumnItem.react","TetraNullState.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=(i||(i=d("react"))).c,k=i;function a(){var a=j(1),b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=k.jsx(c("CometColumn.react"),{expanding:!0,verticalAlign:"center",children:k.jsx(c("CometColumnItem.react"),{children:k.jsx(c("TetraNullState.react"),{headline:h._("__JHASH__f1n8ff4Nrlh__JHASH__")})})}),a[0]=b):b=a[0];return b}g["default"]=a}),226);
__d("MWV2MediaViewerItem.react",["I64","LSIntEnum","MWMediaViewerRenderQpl","MWV2MediaViewerItemImage.react","MWV2MediaViewerItemVideo.react","MWV2MediaViewerNullState.react","MessagingAttachmentType","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=(h||(h=d("react"))).c,l=h;function a(a){var b=k(10),e=a.attachment,f=a.onClose;a=a.threadType;if(e==null){var g;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(g=l.jsx(c("MWV2MediaViewerNullState.react"),{}),b[0]=g):g=b[0];return g}g=e.attachmentType;if(!((i||(i=d("I64"))).equal(g,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(g,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))||(i||(i=d("I64"))).equal(g,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO)))){b[1]===Symbol["for"]("react.memo_cache_sentinel")?(g=l.jsx(c("MWV2MediaViewerNullState.react"),{}),b[1]=g):g=b[1];return g}b[2]!==f?(g=c("gkx")("6691")&&l.jsx("div",{"aria-hidden":!0,className:"x1ey2m1c xds687c x17qophe x10l6tqk x13vifvy","data-testid":void 0,onClick:f}),b[2]=f,b[3]=g):g=b[3];b[4]!==e||b[5]!==a?(f=l.jsx(m,{attachment:e,threadType:a}),b[4]=e,b[5]=a,b[6]=f):f=b[6];b[7]!==g||b[8]!==f?(e=l.jsxs(l.Fragment,{children:[g,f]}),b[7]=g,b[8]=f,b[9]=e):e=b[9];return e}function m(a){var b=k(4),e=a.attachment;a=a.threadType;a=d("MWMediaViewerRenderQpl").useMediaViewerRenderQpl(e,a);var f=e.attachmentType,g;b[0]!==f||b[1]!==e||b[2]!==a?(g=(i||(i=d("I64"))).equal(f,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(f,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))?l.jsx(c("MWV2MediaViewerItemImage.react"),{attachment:e,mediaRenderQpl:a}):(i||(i=d("I64"))).equal(f,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))?l.jsx(c("MWV2MediaViewerItemVideo.react"),{attachment:e,mediaRenderQpl:a}):null,b[0]=f,b[1]=e,b[2]=a,b[3]=g):g=b[3];return g}g["default"]=a}),98);
__d("MWV2MediaViewerContent.react",["fbt","CometBlurredBackgroundImage.react","CometHideLayerOnEscape.react","CometPlaceholder.react","I64","LSIntEnum","MWChatAttachmentMediaNavigationHotkeys.react","MWChatAttachmentMediaState.react","MWChatAttachmentMediaThumbnails.react","MWChatMediaViewerNavigationTapTarget.react","MWV2MediaViewerContainer.react","MWV2MediaViewerContext.react","MWV2MediaViewerControls.react","MWV2MediaViewerControlsFallback.react","MWV2MediaViewerItem.react","MWXColumn.react","MWXColumnItem.react","MWXRow.react","MWXRowItem.react","MessagingAttachmentType","ReQL","ReQLSuspense","gkx","justknobx","react","react-forget-runtime","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m=j||(j=d("react"));b=j;b.useContext;var n=b.useEffect,o=b.c,p={mediaItem:{marginTop:"x14vqqas",marginEnd:"xq8finb",marginBottom:"xod5an3",marginStart:"x16n37ib",$$css:!0},mediaRow:{minHeight:"x2lwn1j",$$css:!0},noOverflow:{maxWidth:"x193iq5w",overflowX:"x6ikm8r",overflowY:"x10wlt62",$$css:!0}};function q(a){var b=o(6);a=a.attachment;var e=d("react-forget-runtime").useContextWithBailoutExperiment__unstable(d("MWV2MediaViewerContext.react").context,r);e=e.getPreviewUrl;var f;b[0]!==e||b[1]!==a?(f=e(a,"BlurredBackground"),b[0]=e,b[1]=a,b[2]=f):f=b[2];e=f;if(e!=null&&a!=null&&!(k||(k=d("I64"))).equal(a.attachmentType,(l||(l=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))){b[3]===Symbol["for"]("react.memo_cache_sentinel")?(f="x1ey2m1c xds687c x17qophe xuzhngd x10l6tqk x13vifvy",b[3]=f):f=b[3];b[4]!==e?(a=m.jsx("div",{className:f,children:m.jsx(c("CometBlurredBackgroundImage.react"),{src:e})}),b[4]=e,b[5]=a):a=b[5];return a}else return null}function r(a){return[a.getPreviewUrl]}function a(a){var b=o(69),e=a.initialAttachment,g=a.onClose,j=a.shouldShowMessengerLogo;a=a.thread;var k=d("react-forget-runtime").useContextWithBailoutExperiment__unstable(d("MWChatAttachmentMediaState.react").context,t),l=k.canMoveBackward,r=k.canMoveForward,u=k.card,v=k.currentIndex,w=k.moveBackward,x=k.moveForward,y=k.numberOfCards;k=k.shouldTriggerLoadMore;var z=d("react-forget-runtime").useContextWithBailoutExperiment__unstable(d("MWV2MediaViewerContext.react").context,s),A=z.getPreviewUrl,B=z.loadMore,C=(i||(i=c("useReStore")))(),D=e==null?void 0:e.threadKey,E=e==null?void 0:e.messageId;b[0]!==C.tables.attachments||b[1]!==D||b[2]!==E?(z=function(){return d("ReQL").fromTableDescending(C.tables.attachments).getKeyRange(D,E)},b[0]=C.tables.attachments,b[1]=D,b[2]=E,b[3]=z):z=b[3];var F;b[4]!==C||b[5]!==E||b[6]!==D?(F=[C,E,D],b[4]=C,b[5]=E,b[6]=D,b[7]=F):F=b[7];z=d("ReQLSuspense").useFirst(z,F,f.id+":109")!=null;var G=u!=null?u.attachment:z?e:void 0;b[8]!==G||b[9]!==C.tables.messages?(F=function(){return(G==null?void 0:G.messageId)==null?d("ReQL").empty():d("ReQL").fromTableAscending(C.tables.messages.index("messageId")).getKeyRange(G.messageId)},b[8]=G,b[9]=C.tables.messages,b[10]=F):F=b[10];u=G==null?void 0:G.messageId;b[11]!==u||b[12]!==C.tables.messages?(z=[u,C.tables.messages],b[11]=u,b[12]=C.tables.messages,b[13]=z):z=b[13];e=d("ReQLSuspense").useFirst(F,z,f.id+":125");b[14]!==k||b[15]!==y||b[16]!==v?(u=c("justknobx")._("1571")?k:v>y-5,b[14]=k,b[15]=y,b[16]=v,b[17]=u):u=b[17];var H=u;b[18]!==H||b[19]!==B?(F=function(){H&&B()},z=[H,B],b[18]=H,b[19]=B,b[20]=F,b[21]=z):(F=b[20],z=b[21]);n(F,z);k=c("gkx")("1775");b[22]!==G||b[23]!==g||b[24]!==a.threadType?(y=m.jsx(c("MWV2MediaViewerItem.react"),{attachment:G,onClose:g,threadType:a.threadType}),b[22]=G,b[23]=g,b[24]=a.threadType,b[25]=y):y=b[25];v=y;b[26]!==g?(u=g!=null?m.jsx(c("MWV2MediaViewerControlsFallback.react"),{onClose:g}):null,b[26]=g,b[27]=u):u=b[27];b[28]!==G||b[29]!==e||b[30]!==g||b[31]!==a?(F=m.jsx(c("MWV2MediaViewerControls.react"),{attachment:G,message:e,onClose:g,thread:a}),b[28]=G,b[29]=e,b[30]=g,b[31]=a,b[32]=F):F=b[32];b[33]!==u||b[34]!==F?(z=m.jsx(c("CometPlaceholder.react"),{fallback:u,name:"MWV2MediaViewerContent.Controls",children:F}),b[33]=u,b[34]=F,b[35]=z):z=b[35];y=k?g:void 0;b[36]!==y?(e=m.jsx(d("MWChatAttachmentMediaNavigationHotkeys.react").MWChatAttachmentMediaNavigationHotkeys,{onClose:y}),b[36]=y,b[37]=e):e=b[37];b[38]!==G?(a=m.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWV2MediaViewerContent.BlurredBackground",children:m.jsx(q,{attachment:G})}),b[38]=G,b[39]=a):a=b[39];b[40]===Symbol["for"]("react.memo_cache_sentinel")?(u=[p.mediaRow,k&&p.noOverflow],b[40]=u):u=b[40];F=!l;b[41]===Symbol["for"]("react.memo_cache_sentinel")?(y=h._("__JHASH__LwpPfoJWBJ-__JHASH__"),b[41]=y):y=b[41];b[42]!==F||b[43]!==w?(l=m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("MWChatMediaViewerNavigationTapTarget.react"),{direction:"previous",invisible:F,label:y,onClick:w,testid:void 0})}),b[42]=F,b[43]=w,b[44]=l):l=b[44];b[45]!==v?(y=m.jsx(c("MWXRowItem.react"),{expanding:!0,verticalAlign:"stretch",xstyle:k&&p.mediaItem,children:m.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWV2MediaViewerContent.MediaContent",children:v})}),b[45]=v,b[46]=y):y=b[46];F=!r;b[47]===Symbol["for"]("react.memo_cache_sentinel")?(w=h._("__JHASH__37s-bUHecpV__JHASH__"),b[47]=w):w=b[47];b[48]!==F||b[49]!==x?(v=m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("MWChatMediaViewerNavigationTapTarget.react"),{direction:"next",invisible:F,label:w,onClick:x,testid:void 0})}),b[48]=F,b[49]=x,b[50]=v):v=b[50];b[51]!==l||b[52]!==y||b[53]!==v?(r=m.jsx(c("MWXColumnItem.react"),{expanding:!0,verticalAlign:"center",children:m.jsxs(c("MWXRow.react"),{align:"justify",expanding:!0,paddingHorizontal:0,paddingVertical:0,spacingHorizontal:k?0:void 0,verticalAlign:"stretch",xstyle:u,children:[l,y,v]})}),b[51]=l,b[52]=y,b[53]=v,b[54]=r):r=b[54];b[55]!==A?(w=m.jsx(c("MWXColumnItem.react"),{children:m.jsx(c("MWChatAttachmentMediaThumbnails.react"),{getPreviewUrl:A})}),b[55]=A,b[56]=w):w=b[56];b[57]!==r||b[58]!==w?(F=m.jsxs(c("MWXColumn.react"),{align:"stretch",expanding:!0,paddingHorizontal:0,verticalAlign:"space-between",children:[r,w]}),b[57]=r,b[58]=w,b[59]=F):F=b[59];b[60]!==z||b[61]!==j||b[62]!==e||b[63]!==a||b[64]!==F?(x=m.jsxs(c("MWV2MediaViewerContainer.react"),{actions:z,shouldShowMessengerLogo:j,children:[e,a,F]}),b[60]=z,b[61]=j,b[62]=e,b[63]=a,b[64]=F,b[65]=x):x=b[65];u=x;if(g!=null&&!k){b[66]!==g||b[67]!==u?(l=m.jsx(c("CometHideLayerOnEscape.react"),{onHide:g,children:u}),b[66]=g,b[67]=u,b[68]=l):l=b[68];return l}else return u}function s(a){return[a.getPreviewUrl,a.loadMore]}function t(a){return[a.canMoveBackward,a.canMoveForward,a.card,a.currentIndex,a.moveBackward,a.moveForward,a.numberOfCards,a.shouldTriggerLoadMore]}g["default"]=a}),226);
__d("useLoadMoreThreadSharedAttachments.react",["Int64Hooks","LSFactory","LSIssueAttachmentsRangeQueryStoredProcedure","MAWThreadCutover","MWThreadKey.react","gkx","promiseDone","react","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).c;function a(a,b,e){var g=i(11),h=c("useAsyncReStore")(),j=d("MWThreadKey.react").useMWThreadKeyMemoized();j==null&&(j=b);b=d("MAWThreadCutover").useGetCutoverOpenThreadKey(j);var k=b&&c("gkx")("2616")===!0?b:j,l;g[0]!==e||g[1]!==h||g[2]!==a||g[3]!==k?(l=function(){e==null?void 0:e(),c("promiseDone")(h,function(b){return b.runInTransaction(function(b){return c("LSIssueAttachmentsRangeQueryStoredProcedure")(c("LSFactory")(b),{mediaGroup:a,threadKey:k})},"readwrite",void 0,void 0,f.id+":45")})},g[0]=e,g[1]=h,g[2]=a,g[3]=k,g[4]=l):l=g[4];var m;g[5]!==e||g[6]!==h||g[7]!==a||g[8]!==b||g[9]!==j?(m=[e,h,a,b,j],g[5]=e,g[6]=h,g[7]=a,g[8]=b,g[9]=j,g[10]=m):m=g[10];return d("Int64Hooks").useCallbackInt64(l,m)}g["default"]=a}),98);
__d("useMAWLoadMoreThreadSharedAttachments",["I64","Int64Hooks","MAWBridgeSendAndReceive","MAWMiActOnActThreadReady","gkx","promiseDone","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=(i||d("react")).c,l=(j||(j=d("I64"))).of_string("9999999999999");function a(a,b,e,f,g,i,m){var n=k(13),o=(h||(h=c("useReStore")))(),p,q;n[0]!==b||n[1]!==e?(p=function(){return b!=null&&b&&e!=null?c("gkx")("2616")===!0?(j||(j=d("I64"))).to_float(e):(j||(j=d("I64"))).to_int32(e):c("gkx")("2616")===!0?Number.MAX_SAFE_INTEGER:(j||(j=d("I64"))).to_int32(l)},q=[b,e],n[0]=b,n[1]=e,n[2]=p,n[3]=q):(p=n[2],q=n[3]);var r=d("Int64Hooks").useCallbackInt64(p,q);n[4]!==a||n[5]!==g||n[6]!==o.tables||n[7]!==f||n[8]!==r||n[9]!==i||n[10]!==m?(p=function(){a!=null&&(g==null?void 0:g(),c("promiseDone")(d("MAWMiActOnActThreadReady").onActThreadReady(o.tables,a,"useMAWLoadMoreThreadSharedAttachments",function(a,b){return d("MAWBridgeSendAndReceive").sendAndReceive("backend","loadMoreMedia",{earliestLoadedMediaMessageId:f,earliestLoadedMediaTs:r(),mediaGalleryGroup:c("gkx")("1338")===!0?i:void 0,pageSize:m,threadJid:b})})))},q=[a,g,o.tables,f,r,i,m],n[4]=a,n[5]=g,n[6]=o.tables,n[7]=f,n[8]=r,n[9]=i,n[10]=m,n[11]=p,n[12]=q):(p=n[11],q=n[12]);return d("Int64Hooks").useCallbackInt64(p,q)}g["default"]=a}),98);
__d("useMAWQuerySecureMediaAttachments",["I64","LSIntEnum","LSThreadMediaGalleryGroup","MWSharedAttachmentsSectionHooks","ReQL","ReQLSuspense","gkx","justknobx","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;b=k||d("react");var l=b.useCallback,m=b.useMemo,n=c("justknobx")._("1132");function a(a,b){b=b===void 0?{}:b;b=b.removeUnsentMessages;var e=b===void 0?!1:b,g=(h||(h=c("useReStore")))();b=d("MWSharedAttachmentsSectionHooks").useAttachmentsQuery(a,(i||(i=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS));var k=b.attachmentsRange,p=b.hasMoreBefore,r=b.minTimestampMs,s=b.query,t=l(function(a){if(!d("MWSharedAttachmentsSectionHooks").filterMediaAttachments(a))return null;var b=d("ReQLSuspense").first(d("ReQL").fromTableAscending(g.tables.messages.index("messageId")).getKeyRange(a.messageId),f.id+":76");if(e&&(b==null||b.isUnsent))return null;return c("gkx")("5318")===!0?b==null?{attachment:a}:{attachment:a,message:b}:{attachment:a}},[g,e]),u=d("ReQLSuspense").useArray(function(){if(c("gkx")("1338")===!0){var a=s.map(t).filter(Boolean);(r==null||(j||(j=d("I64"))).equal(r,(j||(j=d("I64"))).zero))&&(a=a.take(n));return a}else return s.map(t).filter(Boolean)},[g,a,t,r],f.id+":98"),v=m(function(){var a=o(u);c("gkx")("5318")===!0&&a.sort(q);return a},[u]);b=m(function(){return v.map(function(a){a=a.attachment;return a})},[v]);return[b,i.ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),k,r,p]}function o(a){var b=p(a);return a.map(function(a){var c,e=a.attachment;a=a.message;var f=a==null?void 0:a.groupId;c=b.get((c=f)!=null?c:"");if(f==null||c==null){return{attachment:e,message:a,sortKey:{sortingMessageGroupIndex:Number.MAX_SAFE_INTEGER,sortingMessageId:e.messageId,sortingMessagePrimarySortTS:(f=a==null?void 0:a.primarySortKey)!=null?f:e.timestampMs,sortingMessageSecondarySortTS:(f=(f=a==null?void 0:a.secondarySortKey)!=null?f:a==null?void 0:a.timestampMs)!=null?f:e.timestampMs}}}return{attachment:e,message:a,sortKey:{sortingMessageGroupIndex:(j||(j=d("I64"))).to_int32((f=a==null?void 0:a.groupIndex)!=null?f:(j||(j=d("I64"))).zero),sortingMessageId:c.messageId,sortingMessagePrimarySortTS:c.primarySortTs,sortingMessageSecondarySortTS:c.secondarySortTs}}})}function p(a){var b=new Map();a.forEach(function(a){var c;a=a.message;if(!a||a.groupId==null||a.groupIndex==null)return;var e=a.groupId,f=(j||(j=d("I64"))).to_int32(a.groupIndex);c=Math.min((c=(c=b.get(e))==null?void 0:c.groupIndex)!=null?c:Number.MAX_SAFE_INTEGER,f);f=f===c?{groupIndex:f,messageId:a.messageId,primarySortTs:a.primarySortKey,secondarySortTs:(c=a.secondarySortKey)!=null?c:a.timestampMs}:b.get(e);f&&b.set(e,f)});return b}function q(a,b){var c=a.sortKey,e=b.sortKey;a=a.message;b=b.message;if(!(j||(j=d("I64"))).equal(c.sortingMessagePrimarySortTS,e.sortingMessagePrimarySortTS))return(j||(j=d("I64"))).compare(e.sortingMessagePrimarySortTS,c.sortingMessagePrimarySortTS);if(!(j||(j=d("I64"))).equal(e.sortingMessageSecondarySortTS,c.sortingMessageSecondarySortTS))return(j||(j=d("I64"))).compare(e.sortingMessageSecondarySortTS,c.sortingMessageSecondarySortTS);if(c.sortingMessageId!==e.sortingMessageId)return e.sortingMessageId.localeCompare(c.sortingMessageId);return(a==null?void 0:a.groupId)!=null&&(b==null?void 0:b.groupId)!=null&&a.groupId===b.groupId?e.sortingMessageGroupIndex-c.sortingMessageGroupIndex:0}g.useMAWQuerySecureMediaAttachments=a}),98);
__d("useMWMediaLoadingQplLogger",["MWMediaRenderQplUtils","QPLUserFlow","QuickPerformanceLogger","Random","gkx","qpl","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b=i||d("react");b.useCallback;var j=b.useEffect;b.useMemo;var k=b.c;function a(a){var b=k(10),d=a.entrypoint,e=a.threadType;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a=o(),b[0]=a):a=b[0];a=a;var f=a;b[1]!==d||b[2]!==e?(a=function(a){var b;if(!c("gkx")("2616"))return;l({entrypoint:d,instanceKey:f,isCutoverThread:(b=a==null?void 0:a.isCutoverThread)!=null?b:!1,isPreCutoverMedia:(b=a==null?void 0:a.isPreCutoverMedia)!=null?b:!1,threadType:e})},b[1]=d,b[2]=e,b[3]=a):a=b[3];a=a;var g;b[4]===Symbol["for"]("react.memo_cache_sentinel")?(g=function(a){var b=a.fetchedMediaCount,d=a.isAlreadyPreloaded;a=a.startMediaCount;if(!c("gkx")("2616"))return;m({fetchedMediaCount:b,instanceKey:f,isAlreadyPreloaded:d,startMediaCount:a})},b[4]=g):g=b[4];g=g;var i;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(i=function(){if(!c("gkx")("2616"))return;n({instanceKey:f})},b[5]=i):i=b[5];var p=i,q;b[6]===Symbol["for"]("react.memo_cache_sentinel")?(i=function(){return function(){var a=(h||(h=c("QuickPerformanceLogger"))).isMarkerOn(c("qpl")._(25300395,"1954"),f);a&&p()}},q=[f,p],b[6]=i,b[7]=q):(i=b[6],q=b[7]);j(i,q);b[8]!==a?(i={logLoadMediaCancel:p,logLoadMediaStart:a,logLoadMediaSuccess:g},b[8]=a,b[9]=i):i=b[9];q=i;return q}function l(a){var b=a.entrypoint,e=a.instanceKey,f=a.isCutoverThread;f=f===void 0?!1:f;var g=a.isPreCutoverMedia;g=g===void 0?!1:g;a=a.threadType;c("QPLUserFlow").start(c("qpl")._(25300395,"1954"),{annotations:{bool:{isCutoverThread:f,isPreCutoverMedia:g},string:{entrypoint:b,threadType:d("MWMediaRenderQplUtils").getThreadTypeStringFromEnum(a)}},cancelOnUnload:!0,instanceKey:e,timeoutInMs:60*1e3})}function m(a){var b=a.fetchedMediaCount,d=a.instanceKey,e=a.isAlreadyPreloaded;a=a.startMediaCount;c("QPLUserFlow").endSuccess(c("qpl")._(25300395,"1954"),{annotations:{bool:{isAlreadyPreloaded:(e=e)!=null?e:!1},"int":{fetchedMediaCount:b,startMediaCount:a}},instanceKey:d})}function n(a){a=a.instanceKey;c("QPLUserFlow").endCancel(c("qpl")._(25300395,"1954"),{instanceKey:a})}function o(){return Date.now()+Math.round(d("Random").random()*1e4)}g["default"]=a}),98);
__d("useMAWLoadMoreCutoverThreadSharedAttachments",["MAWDbMsg","MWSharedAttachmentsSectionHooks","gkx","justknobx","react","useLoadMoreThreadSharedAttachments.react","useMAWLoadMoreThreadSharedAttachments","useMAWQuerySecureMediaAttachments","useMWMediaLoadingQplLogger"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useCallback;var i=b.c;function a(a,b,e,f,g,h,k){var l,m=i(45),n=d("useMAWQuerySecureMediaAttachments").useMAWQuerySecureMediaAttachments(a),o=n[0],p=n[1],q=n[2],r=n[3];n=n[4];var s;m[0]!==(q==null?void 0:q.lastLoadedMessageId)?(s=(q==null?void 0:q.lastLoadedMessageId)!=null?d("MAWDbMsg").toMsgId(q==null?void 0:q.lastLoadedMessageId):void 0,m[0]=q==null?void 0:q.lastLoadedMessageId,m[1]=s):s=m[1];s=s;l=(l=n)!=null?l:!0;var t;m[2]!==f.entrypoint||m[3]!==e?(t={entrypoint:f.entrypoint,threadType:e},m[2]=f.entrypoint,m[3]=e,m[4]=t):t=m[4];var u=c("useMWMediaLoadingQplLogger")(t);m[5]!==u?(f=function(){u.logLoadMediaStart({isCutoverThread:!0,isPreCutoverMedia:!1})},m[5]=u,m[6]=f):f=m[6];e=f;f=c("useMAWLoadMoreThreadSharedAttachments")(a,n,r,(t=s)!=null?t:void 0,e,g,k);a=d("MWSharedAttachmentsSectionHooks").useQueryMediaAttachments(b);n=a[0];r=a[2];s=a[4];m[7]===Symbol["for"]("react.memo_cache_sentinel")?(t=c("justknobx")._("2968"),m[7]=t):t=m[7];e=t;k=((g=s)!=null?g:c("gkx")("6241"))?e:!1;m[8]!==u?(a=function(){u.logLoadMediaStart({isCutoverThread:!0,isPreCutoverMedia:!0})},m[8]=u,m[9]=a):a=m[9];t=a;s=c("useLoadMoreThreadSharedAttachments.react")(p,b,t);m[10]!==q||m[11]!==l||m[12]!==f||m[13]!==u.logLoadMediaCancel||m[14]!==u.logLoadMediaSuccess||m[15]!==o?(g={attachmentsRange:q,hasMore:l,loadMore:f,logLoadMediaCancel:u.logLoadMediaCancel,logLoadMediaSuccess:u.logLoadMediaSuccess,media:o},m[10]=q,m[11]=l,m[12]=f,m[13]=u.logLoadMediaCancel,m[14]=u.logLoadMediaSuccess,m[15]=o,m[16]=g):g=m[16];e=d("MWSharedAttachmentsSectionHooks").useLoader(g);a=e[0];p=e[1];b=e[2];t=l||a;m[17]!==r||m[18]!==k||m[19]!==s||m[20]!==u.logLoadMediaCancel||m[21]!==u.logLoadMediaSuccess||m[22]!==n||m[23]!==t?(q={attachmentsRange:r,hasMore:k,loadMore:s,logLoadMediaCancel:u.logLoadMediaCancel,logLoadMediaSuccess:u.logLoadMediaSuccess,media:n,skipInitialLoad:t},m[17]=r,m[18]=k,m[19]=s,m[20]=u.logLoadMediaCancel,m[21]=u.logLoadMediaSuccess,m[22]=n,m[23]=t,m[24]=q):q=m[24];f=d("MWSharedAttachmentsSectionHooks").useLoader(q);g=f[0];e=f[1];r=f[2];if(l||a||h===!0){m[25]!==o||m[26]!==b||m[27]!==l||m[28]!==a||m[29]!==p?(s={attachments:o,completedFirstLoad:b,hasMore:l,isLoadingMore:a,onLoadMore:p},m[25]=o,m[26]=b,m[27]=l,m[28]=a,m[29]=p,m[30]=s):s=m[30];return s}else if(k||g){m[31]!==o||m[32]!==n?(t=o.concat(n),m[31]=o,m[32]=n,m[33]=t):t=m[33];m[34]!==t||m[35]!==r||m[36]!==k||m[37]!==g||m[38]!==e?(q={attachments:t,completedFirstLoad:r,hasMore:k,isLoadingMore:g,onLoadMore:e},m[34]=t,m[35]=r,m[36]=k,m[37]=g,m[38]=e,m[39]=q):q=m[39];return q}else{m[40]!==o||m[41]!==n?(f=o.concat(n),m[40]=o,m[41]=n,m[42]=f):f=m[42];m[43]!==f?(h={attachments:f,completedFirstLoad:!0,hasMore:!1,isLoadingMore:!1,onLoadMore:j},m[43]=f,m[44]=h):h=m[44];return h}}function j(){}g["default"]=a}),98);
__d("useMWV2MediaViewerOpenPlayableUrl",["I64","LSIntEnum","LSMediaUrlAttachment","MessagingAttachmentType","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;(h||d("react")).useCallback;function a(){return k}function k(a){if(a==null)return;return(i||(i=d("I64"))).equal(a.attachmentType,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))?d("LSMediaUrlAttachment").previewUrl(a):d("LSMediaUrlAttachment").playableUrl(a)}g["default"]=a}),98);
__d("useMWV2MediaViewerOpenDownloadUrl",["gkx","react","useMWV2MediaViewerOpenPlayableUrl"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useCallback;var i=b.c;function a(){var a=i(2),b=c("useMWV2MediaViewerOpenPlayableUrl")(),d;a[0]!==b?(d=function(a,d,e){a=b(a,d,e);if(a==null)return;if(!c("gkx")("3973"))return a;d=new URL(a);d.searchParams.set("dl","1");return d.toString()},a[0]=b,a[1]=d):d=a[1];return d}g["default"]=a}),98);
__d("useMWV2MediaViewerOpenPreviewUrl",["LSMediaUrlAttachment","react"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){return i}function i(a){return a!=null?d("LSMediaUrlAttachment").previewUrl(a):void 0}g["default"]=a}),98);
__d("useMWV2MediaViewerSecurePlayableUrl",["cr:5970","react"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){return i}function i(a,c,d){return(a=b("cr:5970")==null?void 0:b("cr:5970").getAttachmentBlob(a,c,d))!=null?a:""}g["default"]=a}),98);
__d("useMWV2MediaViewerSecurePreviewUrl",["cr:5931","react"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){return i}function i(a,c,d){return b("cr:5931")==null?void 0:b("cr:5931").getThumbnailBlob(a,c,d)}g["default"]=a}),98);
__d("MWV2MediaViewerCutoverWrapper.react",["LSThreadMediaGalleryGroup","MWChatAttachmentMediaState.react","MWInboxMessageSearchStatusTypes","MWV2MediaViewerContext.react","cr:7829","emptyFunction","justknobx","react","useEmptyFunction","useMAWLoadMoreCutoverThreadSharedAttachments","useMWMediaGalleryRestoreStatus","useMWV2MediaViewerOpenDownloadUrl","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl","useMWV2MediaViewerSecurePlayableUrl","useMWV2MediaViewerSecurePreviewUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));e=h;e.useCallback;var j=e.c,k=(f=b("cr:7829"))!=null?f:c("useEmptyFunction");function a(a){var b=j(30),e=a.children,f=a.initialAttachment,g=a.openThreadKey,h=a.secureThreadKey;a=a.threadType;var m;b[0]!==h||b[1]!==a?(m={threadKey:h,threadType:a},b[0]=h,b[1]=a,b[2]=m):m=b[2];k(m);b[3]!==h||b[4]!==a?(m={threadKey:h,threadType:a},b[3]=h,b[4]=a,b[5]=m):m=b[5];m=c("useMWMediaGalleryRestoreStatus")(m);m=m===d("MWInboxMessageSearchStatusTypes").RestoreStatus.IN_PROGRESS;var n;b[6]===Symbol["for"]("react.memo_cache_sentinel")?(n={entrypoint:"media_viewer"},b[6]=n):n=b[6];var o;b[7]===Symbol["for"]("react.memo_cache_sentinel")?(o=c("justknobx")._("3233"),b[7]=o):o=b[7];h=c("useMAWLoadMoreCutoverThreadSharedAttachments")(h,g,a,n,c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS,m,o);g=h.attachments;a=h.onLoadMore;var p=l,q=c("useMWV2MediaViewerOpenPreviewUrl")(),r=c("useMWV2MediaViewerOpenPlayableUrl")(),s=c("useMWV2MediaViewerOpenDownloadUrl")(),t=c("useMWV2MediaViewerSecurePreviewUrl")(),u=c("useMWV2MediaViewerSecurePlayableUrl")();b[8]!==q||b[9]!==t?(n=function(a,b,c){if(!a)return"";return!p(a)?q(a,b,c):t(a,b,c)},b[8]=q,b[9]=t,b[10]=n):n=b[10];m=n;b[11]!==r||b[12]!==u?(o=function(a,b,c){if(a==null)return"";return!p(a)?r(a,b,c):u(a,b,c)},b[11]=r,b[12]=u,b[13]=o):o=b[13];h=o;b[14]!==s||b[15]!==u?(n=function(a,b,c){if(a==null)return"";return!p(a)?s(a,b,c):u(a,b,c)},b[14]=s,b[15]=u,b[16]=n):n=b[16];o=n;b[17]!==g||b[18]!==h||b[19]!==m||b[20]!==f||b[21]!==e?(n=i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:g,getIsSecureThread:p,getPlayableUrl:h,getPreviewUrl:m,initialAttachment:f,children:e}),b[17]=g,b[18]=h,b[19]=m,b[20]=f,b[21]=e,b[22]=n):n=b[22];b[23]!==o||b[24]!==h||b[25]!==m||b[26]!==a||b[27]!==g||b[28]!==n?(f=i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:o,getPlayableUrl:h,getPreviewUrl:m,heroLoggingComponent:c("emptyFunction"),loadMore:a,media:g,children:n}),b[23]=o,b[24]=h,b[25]=m,b[26]=a,b[27]=g,b[28]=n,b[29]=f):f=b[29];return f}function l(a){return!((a==null?void 0:a.transportKey)==="FBBroker"||(a==null?void 0:a.transportKey)==="FBLegacyBroker")}g["default"]=a}),98);
__d("MWV2MediaViewerOpenWrapper.react",["CometHero.react","MWChatAttachmentMediaState.react","MWSharedAttachmentsSectionHooks","MWV2MediaViewerContext.react","react","useLoadMoreThreadSharedAttachments.react","useMWMediaLoadingQplLogger","useMWV2MediaViewerOpenDownloadUrl","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useCallback;var j=b.c;function a(a){var b=j(22),e=a.children,f=a.initialAttachment;a=a.thread;var g=d("MWSharedAttachmentsSectionHooks").useQueryMediaAttachments(a.threadKey),h=g[0],m=g[1],n=g[2];g[3];g=g[4];var o;b[0]!==a.threadType?(o={entrypoint:"media_viewer",threadType:a.threadType},b[0]=a.threadType,b[1]=o):o=b[1];o=c("useMWMediaLoadingQplLogger")(o);m=c("useLoadMoreThreadSharedAttachments.react")(m,a.threadKey,o.logLoadMediaStart);g=(a=g)!=null?a:!0;b[2]!==n||b[3]!==g||b[4]!==m||b[5]!==o.logLoadMediaCancel||b[6]!==o.logLoadMediaSuccess||b[7]!==h?(a={attachmentsRange:n,hasMore:g,loadMore:m,logLoadMediaCancel:o.logLoadMediaCancel,logLoadMediaSuccess:o.logLoadMediaSuccess,media:h},b[2]=n,b[3]=g,b[4]=m,b[5]=o.logLoadMediaCancel,b[6]=o.logLoadMediaSuccess,b[7]=h,b[8]=a):a=b[8];n=d("MWSharedAttachmentsSectionHooks").useLoader(a);g=n[1];m=c("useMWV2MediaViewerOpenPreviewUrl")();o=c("useMWV2MediaViewerOpenPlayableUrl")();a=c("useMWV2MediaViewerOpenDownloadUrl")();n=l;b[9]!==h||b[10]!==o||b[11]!==m||b[12]!==f||b[13]!==e?(n=i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:h,getIsSecureThread:n,getPlayableUrl:o,getPreviewUrl:m,initialAttachment:f,children:e}),b[9]=h,b[10]=o,b[11]=m,b[12]=f,b[13]=e,b[14]=n):n=b[14];b[15]!==a||b[16]!==o||b[17]!==m||b[18]!==g||b[19]!==h||b[20]!==n?(f=i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:a,getPlayableUrl:o,getPreviewUrl:m,heroLoggingComponent:k,loadMore:g,media:h,children:n}),b[15]=a,b[16]=o,b[17]=m,b[18]=g,b[19]=h,b[20]=n,b[21]=f):f=b[21];return f}function k(a){return i.jsx(c("CometHero.react"),{description:a})}k.displayName=k.name+" [from "+f.id+"]";function l(){return!1}g["default"]=a}),98);
__d("MWV2MediaViewerSecureWrapper.react",["LSThreadMediaGalleryGroup","MAWDbMsg","MWChatAttachmentMediaState.react","MWSharedAttachmentsSectionHooks","MWV2MediaViewerContext.react","MWV2MediaViewerNullState.react","cr:5709","cr:5931","cr:5970","cr:7829","emptyFunction","gkx","justknobx","react","useEmptyFunction","useMAWQuerySecureMediaAttachments","useMWMediaLoadingQplLogger","useMWV2MediaViewerSecurePlayableUrl","useMWV2MediaViewerSecurePreviewUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));f=h;f.useCallback;var j=f.c,k=(f=b("cr:7829"))!=null?f:c("useEmptyFunction");function a(a,b,c,d,e,f,g){return l}function l(){}var m=b("cr:5709")==null?a:b("cr:5709");function e(a){var e=j(28),f=a.children,g=a.initialAttachment;a=a.thread;var h=d("useMAWQuerySecureMediaAttachments").useMAWQuerySecureMediaAttachments(a.threadKey),l=h[0];h[1];var o=h[2],p=h[3];h=h[4];k(a);var q=(h=h)!=null?h:!0;e[0]!==a.threadType?(h={entrypoint:"media_viewer",threadType:a.threadType},e[0]=a.threadType,e[1]=h):h=e[1];h=c("useMWMediaLoadingQplLogger")(h);a=a.threadKey;if(e[2]!==(o==null?void 0:o.lastLoadedMessageId)){var r;r=c("gkx")("2616")===!0?(r=d("MAWDbMsg").toMsgId((r=o==null?void 0:o.lastLoadedMessageId)!=null?r:""))!=null?r:void 0:void 0;e[2]=o==null?void 0:o.lastLoadedMessageId;e[3]=r}else r=e[3];var s=h.logLoadMediaStart,t;e[4]===Symbol["for"]("react.memo_cache_sentinel")?(t=c("justknobx")._("3233"),e[4]=t):t=e[4];var u=m(a,q,p,r,s,c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS,t);e[5]!==q||e[6]!==u?(a=function(){q&&u()},e[5]=q,e[6]=u,e[7]=a):a=e[7];p=a;e[8]!==o||e[9]!==q||e[10]!==p||e[11]!==h.logLoadMediaCancel||e[12]!==h.logLoadMediaSuccess||e[13]!==l?(r={attachmentsRange:o,hasMore:q,loadMore:p,logLoadMediaCancel:h.logLoadMediaCancel,logLoadMediaSuccess:h.logLoadMediaSuccess,media:l},e[8]=o,e[9]=q,e[10]=p,e[11]=h.logLoadMediaCancel,e[12]=h.logLoadMediaSuccess,e[13]=l,e[14]=r):r=e[14];s=d("MWSharedAttachmentsSectionHooks").useLoader(r);t=s[1];a=c("useMWV2MediaViewerSecurePreviewUrl")();o=c("useMWV2MediaViewerSecurePlayableUrl")();p=n;if(b("cr:5970")==null||b("cr:5931")==null){e[15]===Symbol["for"]("react.memo_cache_sentinel")?(h=i.jsx(c("MWV2MediaViewerNullState.react"),{}),e[15]=h):h=e[15];return h}e[16]!==l||e[17]!==o||e[18]!==a||e[19]!==g||e[20]!==f?(r=i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:l,getIsSecureThread:p,getPlayableUrl:o,getPreviewUrl:a,initialAttachment:g,children:f}),e[16]=l,e[17]=o,e[18]=a,e[19]=g,e[20]=f,e[21]=r):r=e[21];e[22]!==o||e[23]!==a||e[24]!==t||e[25]!==l||e[26]!==r?(s=i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:o,getPlayableUrl:o,getPreviewUrl:a,heroLoggingComponent:c("emptyFunction"),loadMore:t,media:l,children:r}),e[22]=o,e[23]=a,e[24]=t,e[25]=l,e[26]=r,e[27]=s):s=e[27];return s}function n(){return!0}g["default"]=e}),98);
__d("MWV2MediaViewer.react",["FBLogger","I64","LSMessagingThreadTypeUtil","MAWMediaGalleryM2Utils","MAWThreadCutover","MWLSThread","MWLSThreadDisplayContext","MWV2MediaViewerContent.react","MWV2MediaViewerCutoverWrapper.react","MWV2MediaViewerNullState.react","MWV2MediaViewerOpenWrapper.react","MWV2MediaViewerSecureWrapper.react","gkx","justknobx","react","requireDeferred","useMWMediaViewerOpenQPLLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||(h=d("react"));b=h;b.useCallback;var k=b.useEffect,l=b.c,m=c("requireDeferred")("MAWFTSRestoreSync").__setRef("MWV2MediaViewer.react");function a(a){var b=l(41),e=a.attachment,f=a.onClose;a=a.shouldShowMessengerLogo;var g=d("useMWMediaViewerOpenQPLLogger").useMWMediaViewerOpenQPLLogger(),h=g.endSuccess,n;b[0]!==h?(g=function(){h()},n=[h],b[0]=h,b[1]=g,b[2]=n):(g=b[1],n=b[2]);k(g,n);g=d("MWLSThreadDisplayContext").useMWLSThreadDisplayContext();var o=g==="ChatTab";b[3]!==o?(n=function(){if(!d("MAWMediaGalleryM2Utils").isMediaGalleryM2Enabled()||!c("justknobx")._("3195"))return;m.onReady(function(a){a=a.getFTSRestoreSync;a=a();o&&(a.setIsStarted(!1),a.setShouldPauseRestore(!0))})},b[3]=o,b[4]=n):n=b[4];var p=n;g=d("MWLSThread").useThread(e.threadKey);n=d("MAWThreadCutover").useGetCutoverOpenThreadKey(e.threadKey);var q=d("MAWThreadCutover").useCutoverSecureThreadKeyForOpenThreadKey(n==null?e.threadKey:void 0);if(g==null){c("FBLogger")("messenger_web_media").mustfix("Thread is null in media viewer for attachment with threadKey: %s",(i||(i=d("I64"))).to_string(e.threadKey));var r;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(r=j.jsx(c("MWV2MediaViewerNullState.react"),{}),b[5]=r):r=b[5];return r}r=d("LSMessagingThreadTypeUtil").isArmadilloSecure(g.threadType);if((n!=null||q!=null)&&c("gkx")("2616")===!0){n=n!=null?n:g.threadKey;q=q!=null?q:g.threadKey;var s;b[6]!==p||b[7]!==f?(s=function(){p(),f&&f()},b[6]=p,b[7]=f,b[8]=s):s=b[8];var t;b[9]!==e||b[10]!==s||b[11]!==a||b[12]!==g?(t=j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:e,onClose:s,shouldShowMessengerLogo:a,thread:g}),b[9]=e,b[10]=s,b[11]=a,b[12]=g,b[13]=t):t=b[13];b[14]!==e||b[15]!==n||b[16]!==q||b[17]!==g.threadType||b[18]!==t?(s=j.jsx(c("MWV2MediaViewerCutoverWrapper.react"),{initialAttachment:e,openThreadKey:n,secureThreadKey:q,threadType:g.threadType,children:t}),b[14]=e,b[15]=n,b[16]=q,b[17]=g.threadType,b[18]=t,b[19]=s):s=b[19];return s}if(r){b[20]!==p||b[21]!==f?(n=function(){p(),f&&f()},b[20]=p,b[21]=f,b[22]=n):n=b[22];b[23]!==e||b[24]!==n||b[25]!==a||b[26]!==g?(q=j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:e,onClose:n,shouldShowMessengerLogo:a,thread:g}),b[23]=e,b[24]=n,b[25]=a,b[26]=g,b[27]=q):q=b[27];b[28]!==e||b[29]!==g||b[30]!==q?(t=j.jsx(c("MWV2MediaViewerSecureWrapper.react"),{initialAttachment:e,thread:g,children:q}),b[28]=e,b[29]=g,b[30]=q,b[31]=t):t=b[31];return t}b[32]!==e||b[33]!==f||b[34]!==a||b[35]!==g?(s=j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:e,onClose:f,shouldShowMessengerLogo:a,thread:g}),b[32]=e,b[33]=f,b[34]=a,b[35]=g,b[36]=s):s=b[36];b[37]!==e||b[38]!==g||b[39]!==s?(r=j.jsx(c("MWV2MediaViewerOpenWrapper.react"),{initialAttachment:e,thread:g,children:s}),b[37]=e,b[38]=g,b[39]=s,b[40]=r):r=b[40];return r}g["default"]=a}),98);